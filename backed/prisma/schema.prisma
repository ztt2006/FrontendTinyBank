generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id           BigInt    @id @default(autoincrement())
  userAccount  String    @db.VarChar(256)
  userPassword String    @db.VarChar(512)
  unionId      String?   @db.VarChar(256)
  mpOpenId     String?   @db.VarChar(256)
  userName     String?   @db.VarChar(256)
  userAvatar   String?   @db.VarChar(1024)
  userProfile  String?   @db.VarChar(512)
  userRole     String    @default("user") @db.VarChar(256)
  editTime     DateTime  @default(now())
  createTime   DateTime  @default(now())
  updateTime   DateTime  @updatedAt
  isDelete     Int       @default(0) @db.TinyInt

  questions           Question[]
  questionBanks       QuestionBank[]
  questionBankQuestions QuestionBankQuestion[]

  @@index([unionId])
  @@map("user")
}

model QuestionBank {
  id          BigInt    @id @default(autoincrement())
  title       String?   @db.VarChar(256)
  description String?   @db.Text
  picture     String?   @db.VarChar(2048)
  userId      BigInt
  editTime    DateTime  @default(now())
  createTime  DateTime  @default(now())
  updateTime  DateTime  @updatedAt
  isDelete    Int       @default(0) @db.TinyInt

  user        User      @relation(fields: [userId], references: [id])
  questionBankQuestions QuestionBankQuestion[]

  @@index([title])
  @@map("question_bank")
}

model Question {
  id         BigInt    @id @default(autoincrement())
  title      String?   @db.VarChar(256)
  content    String?   @db.Text
  tags       String?   @db.VarChar(1024)
  answer     String?   @db.Text
  userId     BigInt
  editTime   DateTime  @default(now())
  createTime DateTime  @default(now())
  updateTime DateTime  @updatedAt
  isDelete   Int       @default(0) @db.TinyInt

  user       User      @relation(fields: [userId], references: [id])
  questionBankQuestions QuestionBankQuestion[]

  @@index([title])
  @@index([userId])
  @@map("question")
}

model QuestionBankQuestion {
  id             BigInt    @id @default(autoincrement())
  questionBankId BigInt
  questionId     BigInt
  userId         BigInt
  createTime     DateTime  @default(now())
  updateTime     DateTime  @updatedAt

  questionBank   QuestionBank @relation(fields: [questionBankId], references: [id])
  question       Question     @relation(fields: [questionId], references: [id])
  user           User         @relation(fields: [userId], references: [id])

  @@unique([questionBankId, questionId])
  @@map("question_bank_question")
}
